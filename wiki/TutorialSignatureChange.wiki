#summary Supress security prompt or change the digital signature publisher name
#labels Featured,Phase-Deploy

= Objective =

Fix "digital signature cannot be verified" message that appears when running jZebra signed applet.  This is done by recompiling jZebra with NetBeans, and replacing the digital certificate with your company's certificate.

  || *Note:* Estimated time to complete: 2 hours ||

https://lh6.googleusercontent.com/-U2UKApbxaak/Th5OMbeqEQI/AAAAAAAAAlQ/dBt897w5SDs/sign.png

https://lh6.googleusercontent.com/-pWKHwSwpWIc/Th5OMSz-0CI/AAAAAAAAAlM/Yn4u7LovyWM/sign2.png

= Prerequisites =

  # This tutorial assumes web server is running Linux or BSD. It can be adapted for others but mileage may vary.
  # Need console access to the web server running OpenSSL
  # Putty (or equivalent) installed, WinSCP (or equivalent) installed
  # Must have an OpenSSL private key used to obtain purchased signing certificate, example "MyCompany.cer"
  # Must have a purchased signing certificate (i.e. Verisign, Thawte, Geotrust), example "CodeSigningCA.cer"
  # Must have a root certificate from said company, example "PrimaryRootCA.cer"
  # Installed and working Java JDK + NetBeans bundle (i.e. [http://www.oracle.com/technetwork/java/javase/downloads/jdk-netbeans-jsp-142931.html NetBeans 7.0, JDK 1.6.x])
  # Installed and working [http://www.oracle.com/technetwork/java/javase/downloads/index-jdk5-jsp-142662.html JDK 1.5.x]

= Setup NetBeans =
  # If not already, install the latest bundled version of Java Development Kit & NetBeans taking defaults. Registration is optional and can be skipped.
  # Register the older 1.5 JDK using Tools, Java Platforms, Add, and navigate to C:\Program Files\Java\jdk1.5.0_xx.
  # Open the project in NetBeans using the following steps:
   * Download the latest [http://code.google.com/p/jzebra/downloads/list?q=label:NetBeans jZebra source]
   * Extract the contents to the NetBeans project folder (Usually "My Documents/NetBeansProjects", or "home/NetBeansProjects") in a folder called "jZebra"
   * With NetBeans open, import the project using File, Open and browse for the newly created "jZebra" folder.
   * In the top left "Projects" pane, you should see a red coffee cup with the word "jzebra" next to it.
    || *Note:*  If "Projects" does not appear in NetBeans, hit CTRL + 1 to make it visible. ||
   * If jzebra appears to be in error (exclamation mark), you may need to change the target platform to the correctly installed JDK: Right-click "jzebra", Properties, Libraries.  Click "JDK 1.5" (if installed) or "JDK 1.6 Default". Click OK.







= Steps =
  || *Note:* Please adjust "MyCompany" and "!mypassword!" appropriately ||
  # Using Putty, connect to the web server console
  # Create a directory on the web server, i.e. "/home/myuser/signing"
   {{{ mkdir ~/signing }}}
  # Using WinSCP, copy three signature files to the new directory on the web server (i.e: CodeSigningCA.cer, PrimaryRootCA.cer, MyCompany.cer)
  # Using OpenSSL through Putty, convert the private key and the code sign cert to PCKS12 format:
   {{{ $ openssl pkcs12 -export -in MyCompany.cer -inkey mycompany.key -out mycompany.p12 -name "mycompany" }}}
  # Using Java keytool, convert the PCKS12 keystore into a JKS keystore:
   {{{ $ keytool -importkeystore -deststorepass !mypassword! -destkeypass !mypassword!
-destkeystore keystore.jks -srckeystore skepr.net.p12 -srcstoretype PKCS12
-srcstorepass %PW% -alias Skepr }}}

  # By default jZebra uses "jzebra.ks" for it's KeyStore.  To use an alternate KeyStore, drag it in to the "Files" panel.  
    || *Note:*  If "Files" does not appear in NetBeans, hit CTRL + 2 to make it visible. Alternately, you can copy it to "NetBeansProjects/jZebra" ||
   # The KeyStore requires four fields: A file name, a store password, a key password and an alias name to be entered.  The compiler will do this automatically so as long as the values are defined in "NetBeansProjects\jZebra\nbprojects\jnlp-impl.xml" as `jnlp.signjar.keystore`, `jnlp.signjar.storepass`, `jnlp.signjar.keypass`, `jnlp.signjar.alias` respectively.
    || *Note:* Be careful as not to break the formatting of the html file. ||
   # Click the [http://2.bp.blogspot.com/_9hmP3Ho0t14/S3CbTCYXxqI/AAAAAAAAAY4/AOvjXs3cgec/s400/Picture+10.png] Hammer + Broom icon to do a clean build.
   # Find your newly created and signed JAR file in your source folder in a folder called "dist" ("NetBeansProjects\jZebra\dist\jZebra.jar")
   # Deploy the new jar to a test web location.
   # Email tres.finocchiaro@gmail.com with questions/comments in this process.






= Change Applet Branding =

If you are NOT using a [http://en.wikipedia.org/wiki/Root_certificate root certificate] to sign jZebra it (Verisign, Thawte, etc), here are the steps to simply change the publisher name when prompted by the Security Dialog:

  # Download the [http://netbeans.org/downloads/ latest version of Netbeans] (The *Java SE* version is sufficient).
  # Install Netbeans taking defaults.  Registration is optional and can be skipped.
  # Download the [http://code.google.com/p/jzebra/downloads latest source code]
  # Extract source to a folder.
  # In Netbeans, click:  *Project --&gt; Open Project --&gt; &lt;browse to the extracted source code&gt;*  The icon should look like a red coffee cup.
  # On the left "Projects" pane, *Right Click* the red coffee cup "jZebra" and click *Properties*
  # Click *Application* from the list on the left.
  # Change vendor from "Tres Finocchiaro" to &lt;Name of Company&gt; and click OK to close the dialog.
  # Click the [http://2.bp.blogspot.com/_9hmP3Ho0t14/S3CbTCYXxqI/AAAAAAAAAY4/AOvjXs3cgec/s400/Picture+10.png] Hammer + Broom icon to do a clean build.
  # Find your newly created and signed JAR file in your source folder in a folder called "dist".



-Tres


|| Please choose your certificate provider wisely.  jZebra is not affiliated with Verisign or Thawte. ||